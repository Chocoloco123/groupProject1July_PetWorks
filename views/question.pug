extends layout.pug

include utils.pug

block content
    include navigation-bar.pug
    div(id='questionUsername') Asked by: #{question.User.username}
    div(id='questionContent') #{question.question}
    if question.userId === userId
        div
            a(href=`/questions/${question.id}/edit` id='editQuestion') Edit
            a(href='/answers/:id/delete' id='deleteQuestion') Delete
    div
        form(action='/answers/new' method='post')
            input(type='hidden' value=question.id name='questionId')
            input(type='hidden' name='_csrf' value=csrfToken)
            button(type='submit' id='addAnswerButton') Add Answer
    if answers
        for answer in answers

            div
                div #{answer.User.username}:
                p= answer.answer
                    div
                        button(type='button') Comment Open/Close
                        if answer.userId === userId
                            div
                                a(href=`/answers/${answer.id}/edit`) Edit
                                a(href='/answers/:id/delete') Delete

                        form(action='/comments' method='post')
                            input(type='hidden' name='_csrf' value=csrfToken)
                            input(type='hidden' value=userId name='userId')
                            input(type='hidden' value=answer.id name='answerId')
                            input(type='hidden' value=question.id name='questionId')
                            +field('', 'comment', null, null, 'Please submit comment...')
                            button(type="submit") Submit
                            if comments
                                for comment in comments
                                    if comment.answerId === answer.id
                                        div
                                            for user in users
                                                if user.id === comment.userId
                                                    div #{user.username}:
                                            p= comment.comment
                                            if comment.userId === userId
                                                div
                                                    a(href=`/comments/${comment.id}/edit` id='editComment') Edit
                                                    a(href='/answers/:id/delete' id='deleteComment') Delete


                        //- if answer.Comments
                        //-     for comment in answer.Comments
                        //-         div
                        //-             p= comment.comment
